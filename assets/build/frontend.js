!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=15)}([function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(9);function o(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=o=Reflect.get,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,n){var o=r(e,t);if(o){var s=Object.getOwnPropertyDescriptor(o,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(this,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=1)}([function(e,t,n){"use strict";n.r(t);var r=0,o=1,s=2,i=3,u=4;class l{constructor(e,t,n){this.startInOld=e,this.startInNew=t,this.size=n}get endInOld(){return this.startInOld+this.size}get endInNew(){return this.startInNew+this.size}}class c{constructor(){this.blockSize=0,this.repeatingWordsAccuracy=0,this.ignoreWhitespaceDifferences=!1}}const a=/^\s*<\/?[^>]+>\s*$/,d=/<[^\s>]+/,p=/^(\s|&nbsp;)+$/,f=/[\w\#@]+/,h=["<img"];function x(e){return!h.some((t=>null!==e&&e.startsWith(t)))&&a.test(e)}function y(e,t,n){return["<",t,' class="',n,'">',e,"</",t,">"].join("")}function w(e){return"<"===e}function m(e){return"&"===e}function g(e){return";"===e}function v(e){return p.test(e)}function b(e){return f.test(e)}function I(e,t,n){return e.push(t),e.length>n&&e.shift(),e.length!==n?null:e.join("")}class _{constructor(e,t,n,r,o,s,i){this.oldWords=e,this.newWords=t,this.startInOld=n,this.endInOld=r,this.startInNew=o,this.endInNew=s,this.options=i}indexNewWords(){this.wordIndices=new Map;let e=[];for(let t=this.startInNew;t<this.endInNew;t++){let n=I(e,this.normalizeForIndex(this.newWords[t]),this.options.blockSize);null!==n&&(this.wordIndices.has(n)?this.wordIndices.get(n).push(t):this.wordIndices.set(n,[t]))}}normalizeForIndex(e){return e=function(e){return x(e)?function(e){return d.exec(e)[0]+(e.endsWith("/>")?"/>":">")}(e):e}(e),this.options.IgnoreWhiteSpaceDifferences&&v(e)?" ":e}findMatch(){if(this.indexNewWords(),this.removeRepeatingWords(),0===this.wordIndices.length)return null;let e=this.startInOld,t=this.startInNew,n=0,r=new Map;const o=this.options.blockSize;let s=[];for(let i=this.startInOld;i<this.endInOld;i++){let u=I(s,this.normalizeForIndex(this.oldWords[i]),o);if(null===u)continue;let l=new Map;if(this.wordIndices.has(u)){for(let s of this.wordIndices.get(u)){let u=(r.has(s-1)?r.get(s-1):0)+1;l.set(s,u),u>n&&(e=i-u-o+2,t=s-u-o+2,n=u)}r=l}else r=l}return 0!==n?new l(e,t,n+o-1):null}removeRepeatingWords(){let e=this.newWords.length+this.options.repeatingWordsAccuracy,t=Array.from(this.wordIndices.entries()).filter((t=>t[1].length>e)).map((e=>e[0]));for(let n of t)this.wordIndices.delete(n)}}class O{constructor(e,t,n,r,o){this.action=e,this.startInOld=t,this.endInOld=n,this.startInNew=r,this.endInNew=o}}var W=0,M=1,k=2,j=3;function N(e,t){let n={mode:W,currentWord:[],words:[]},r=function(e,t){let n=new Map;if(null===t)return n;for(let r of t){let t;for(;null!==(t=r.exec(e));){if(n.has(t.index))throw new Error("One or more block expressions result in a text sequence that overlaps. Current expression: "+r.toString());n.set(t.index,t.index+t[0].length)}}return n}(e,t),o=!!r.size,s=!1,i=-1;for(let l=0;l<e.length;l++){var u=e[l];if(o){i===index&&(i=-1,s=!1);let e=0;if(r.has(index)&&(s=!0,i=e=r.get(index)),s){n.currentWord.push(u),n.mode=W;continue}}switch(n.mode){case W:w(u)?S(n,"<",M):m(u)?S(n,u,j):v(u)?S(n,u,k):b(u)&&(0===n.currentWord.length||b(n.currentWord[n.currentWord.length-1]))?n.currentWord.push(u):S(n,u,W);break;case M:">"===u?(n.currentWord.push(u),n.words.push(n.currentWord.join("")),n.currentWord=[],n.mode=v(u)?k:W):n.currentWord.push(u);break;case k:w(u)?S(n,u,M):m(u)?S(n,u,j):v(u)?n.currentWord.push(u):S(n,u,W);break;case j:if(w(u))S(n,u,M);else if(v(u))S(n,u,k);else if(g(u)){let e=!0;if(0!==n.currentWord.length&&(n.currentWord.push(u),n.words.push(n.currentWord.join("")),n.words.length>2&&v(n.words[n.words.length-2])&&v(n.words[n.words.length-1]))){let t=n.words[n.words.length-2],r=n.words[n.words.length-1];n.words.splice(n.words.length-2,2),n.currentWord=[(t+r).split()],n.mode=k,e=!1}e&&(n.currentWord=[],n.mode=W)}else b(u)?n.currentWord.push(u):S(n,u,W)}}return 0!==n.currentWord.length&&n.words.push(n.currentWord.join("")),n.words}function S(e,t,n){0!==e.currentWord.length&&e.words.push(e.currentWord.join("")),e.currentWord=[t],e.mode=n}const E=new Map([["</strong>",0],["</em>",0],["</b>",0],["</i>",0],["</big>",0],["</small>",0],["</u>",0],["</sub>",0],["</strike>",0],["</s>",0]]),T=/<((strong)|(b)|(i)|(em)|(big)|(small)|(u)|(sub)|(sup)|(strike)|(s))[\>\s]+/gi;class D{constructor(e,t){this.content=[],this.newText=t,this.oldText=e,this.specialTagDiffStack=[],this.newWords=[],this.oldWords=[],this.matchGranularity=0,this.blockExpressions=[],this.repeatingWordsAccuracy=1,this.ignoreWhiteSpaceDifferences=!1,this.orphanMatchThreshold=0}build(){if(this.oldText===this.newText)return this.newText;this.splitInputsIntoWords(),this.matchGranularity=Math.min(4,this.oldWords.length,this.newWords.length);let e=this.operations();for(let t of e)this.performOperation(t);return this.content.join("")}addBlockExpression(e){this.blockExpressions.push(e)}splitInputsIntoWords(){this.oldWords=N(this.oldText,this.blockExpressions),this.oldText=null,this.newWords=N(this.newText,this.blockExpressions),this.newText=null}performOperation(e){switch(e.action){case r:this.processEqualOperation(e);break;case o:this.processDeleteOperation(e,"diffdel");break;case s:this.processInsertOperation(e,"diffins");break;case i:break;case u:this.processReplaceOperation(e)}}processReplaceOperation(e){this.processDeleteOperation(e,"diffmod"),this.processInsertOperation(e,"diffmod")}processInsertOperation(e,t){let n=this.newWords.filter(((t,n)=>n>=e.startInNew&&n<e.endInNew));this.insertTag("ins",t,n)}processDeleteOperation(e,t){let n=this.oldWords.filter(((t,n)=>n>=e.startInOld&&n<e.endInOld));this.insertTag("del",t,n)}processEqualOperation(e){let t=this.newWords.filter(((t,n)=>n>=e.startInNew&&n<e.endInNew));this.content.push(t.join(""))}insertTag(e,t,n){for(;n.length;){let r=this.extractConsecutiveWords(n,(e=>!x(e))),o="",s=!1;if(0!==r.length){let n=y(r.join(""),e,t);this.content.push(n)}else{if(T.test(n[0])){if(this.specialTagDiffStack.push(n[0]),o='<ins class="mod">',"del"===e)for(n.shift();n.length>0&&T.test(n[0]);)n.shift()}else if(E.has(n[0])){let t=0===this.specialTagDiffStack.length?null:this.specialTagDiffStack.pop();if(null!==t&&t===n[0].replace(/\//g,"")&&(o="</ins>",s=!0),"del"===e)for(n.shift();n.length>0&&E.has(n[0]);)n.shift()}if(0===n.length&&0===o.length)break;s?this.content.push(o+this.extractConsecutiveWords(n,x).join("")):this.content.push(this.extractConsecutiveWords(n,x).join("")+o)}}}extractConsecutiveWords(e,t){let n=null;for(let r=0;r<e.length;r++){let o=e[r];if(0===r&&" "===o&&(e[r]="&nbsp;"),!t(o)){n=r;break}}if(null!==n){let t=e.filter(((e,t)=>t>=0&&t<n));return n>0&&e.splice(0,n),t}{let t=e.filter(((t,n)=>n>=0&&n<e.length));return e.splice(0,e.length),t}}operations(){let e=0,t=0,n=[],c=this.matchingBlocks();c.push(new l(this.oldWords.length,this.newWords.length,0));let a=this.removeOrphans(c);for(let l of a){let c,a=e===l.startInOld,d=t===l.startInNew;(c=a||d?a&&!d?s:a?i:o:u)!==i&&n.push(new O(c,e,l.startInOld,t,l.startInNew)),0!==l.length&&n.push(new O(r,l.startInOld,l.endInOld,l.startInNew,l.endInNew)),e=l.endInOld,t=l.endInNew}return n}*removeOrphans(e){let t=null,n=null;for(let r of e){if(null===n){t=new l(0,0,0),n=r;continue}if(t.endInOld===n.startInOld&&t.endInNew===n.startInNew||n.endInOld===r.startInOld&&n.endInNew===r.startInNew){yield n,t=n,n=r;continue}let e=(e,t)=>e+t.length,o=this.oldWords.slice(t.endInOld,r.startInOld).reduce(e,0),s=this.newWords.slice(t.endInNew,r.startInNew).reduce(e,0);this.newWords.slice(n.startInNew,n.endInNew).reduce(e,0)>Math.max(o,s)*this.orphanMatchThreshold&&(yield n),t=n,n=r}yield n}matchingBlocks(){let e=[];return this.findMatchingBlocks(0,this.oldWords.length,0,this.newWords.length,e),e}findMatchingBlocks(e,t,n,r,o){let s=this.findMatch(e,t,n,r);null!==s&&(e<s.startInOld&&n<s.startInNew&&this.findMatchingBlocks(e,s.startInOld,n,s.startInNew,o),o.push(s),s.endInOld<t&&s.endInNew<r&&this.findMatchingBlocks(s.endInOld,t,s.endInNew,r,o))}findMatch(e,t,n,r){for(let o=this.matchGranularity;o>0;o--){let s=new c;s.blockSize=o,s.repeatingWordsAccuracy=this.repeatingWordsAccuracy,s.ignoreWhitespaceDifferences=this.ignoreWhiteSpaceDifferences;let i=new _(this.oldWords,this.newWords,e,t,n,r,s).findMatch();if(null!==i)return i}return null}}D.execute=function(e,t){return new D(e,t).build()},t.default=D},function(e,t,n){e.exports=n(0)}])},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(1);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(10).default,o=n(11);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(0),o=n(1),s=n(12),i=n(13);function u(t){var n="function"===typeof Map?new Map:void 0;return e.exports=u=function(e){if(null===e||!s(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return i(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),o(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,u(t)}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(0);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(1),o=n(14);function s(t,n,i){return o()?(e.exports=s=Reflect.construct,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=s=function(e,t,n){var o=[null];o.push.apply(o,t);var s=new(Function.bind.apply(e,o));return n&&r(s,n.prototype),s},e.exports.__esModule=!0,e.exports.default=e.exports),s.apply(null,arguments)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.r(t);var r=n(3),o=n.n(r),s=n(4),i=n.n(s),u=n(5),l=n.n(u),c=n(2),a=n.n(c),d=n(6),p=n.n(d),f=n(7),h=n.n(f),x=n(0),y=n.n(x),w=n(8);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var g=function(e){p()(n,e);var t=m(n);function n(){return i()(this,n),t.apply(this,arguments)}return l()(n,[{key:"set",value:function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return document.dispatchEvent(new CustomEvent("hm-post-history.revision-added",{detail:{key:r[0],value:r[1]}})),(e=a()(y()(n.prototype),"set",this)).call.apply(e,[this].concat(r))}},{key:"delete",value:function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return document.dispatchEvent(new CustomEvent("hm-post-history.revision-removed",{detail:{key:r[0]}})),(e=a()(y()(n.prototype),"get",this)).call.apply(e,[this].concat(r))}}]),n}(n.n(w)()(Map)),v={api:{base:void 0,nonce:void 0},default:{per_page:void 0},postID:void 0,marker:{selector:void 0}},b="",I=new g;function _(e){var t=document;return e&&(t=e),t.querySelector(v.marker.selector)||!1}function O(){return document.querySelector("button[data-post-history-load-more]")}function W(){var e=function(){var e=_();return!!e&&e.parentElement}();e&&(e.dataset.postHistoryDiffContainer="",e.classList.add("hm-post-history__diff-container"),b=function(e){if(e){var t=e.cloneNode(!0),n=_(t);return n&&t.removeChild(n),t.normalize(),t.innerHTML}return""}(e))}function M(){var e=document.querySelector("[data-post-history-diff-list]");e&&(document.addEventListener("hm-post-history.revision-added",(function(t){var n=t.detail.value,r=n.author,s=n.date,i=n.id,u=document.createElement("li");u.classList.add("hm-post-history__diff"),u.dataset.postHistoryDiffId=i,u.innerHTML='<button class="hm-post-history__select-diff" type="button" value="'.concat(i,'">').concat(s," - ").concat(r,"</button>"),u.addEventListener("click",(function(){!function(e){var t=I.get(e);t&&(function(e){var t=document.querySelector("[data-post-history-diff-container]");t&&(t.innerHTML=o.a.execute(e,b))}(function(e){var t=document.createElement("div");return t.innerHTML=e,t.normalize(),t.innerHTML}(t.content)),document.dispatchEvent(new CustomEvent("hm-post-history.diff-switched",{detail:{currentDiffID:e}})))}(i)})),e.appendChild(u)})),document.addEventListener("hm-post-history.revision-removed",(function(t){var n=e.querySelector('[data-post-history-diff-id="'.concat(t.detail.key,'"]'));n&&e.removeChild(n)})),document.addEventListener("hm-post-history.diff-switched",(function(t){var n=t.detail.currentDiffID;e.querySelectorAll("li").forEach((function(e){e.classList.remove("hm-post-history__diff--current"),parseInt(e.dataset.postHistoryDiffId,10)===n&&e.classList.add("hm-post-history__diff--current")}))})))}function k(){var e=O();e&&(e.addEventListener("click",(function(){var t=parseInt(e.dataset.postHistoryLoadMore,10)||!1;!function(e){"number"!==typeof e&&(e=1);var t=new URL("".concat(v.api.base.pathname,"/revisions/").concat(v.postID,"/"),v.api.base.href);t.searchParams.set("paged",e),t.searchParams.set("per_page",v.default.per_page);var n=new Request(t.href,{credentials:"include",headers:new Headers({"X-WP-Nonce":v.api.nonce})}),r=O();r.classList.add("hm-post-history__load-more--loading"),fetch(n).then((function(e){if(r.classList.remove("hm-post-history__load-more--loading"),e.ok)return e.json();r.classList.add("hm-post-history__load-more--failed")})).then((function(e){e.revisions.map((function(e){return I.has(e.id)||I.set(e.id,e),I})),!1===e.hasMore&&document.dispatchEvent(new Event("hm-post-history.no-more-revisions"))}))}(t),e.dataset.postHistoryLoadMore=++t})),document.addEventListener("hm-post-history.no-more-revisions",(function(){e.hidden=!0,e.disabled=!0})))}(function(){!function(){var e=window.HMPostHistorySettings,t=e.api_base,n=e.api_nonce,r=e.per_page_default,o=window.HMPostHistoryCurrentItem,s=o.post_id,i=o.marker_selector;v.api.base=new URL(t),v.api.nonce=n,v.default.per_page=r,v.postID=parseInt(s,10),v.marker.selector=i}(),"undefined"!=typeof v.api.base&&"undefined"!=typeof v.api.nonce&&"undefined"!=typeof v.default.per_page&&"undefined"!=typeof v.postID&&"undefined"!=typeof v.marker.selector&&(W(),M(),k())})()}]);